function initNavbar(){let e=document.getElementById("navbar");window.addEventListener("scroll",()=>{50<window.scrollY?e.classList.add("scrolled"):e.classList.remove("scrolled")})}function initMobileMenu(){let t=document.getElementById("hamburger"),a=document.getElementById("nav-menu");var e=document.getElementById("navClose");let n=document.getElementById("navOverlay");t&&a&&(t.addEventListener("click",()=>{t.classList.toggle("active"),a.classList.toggle("active"),n&&n.classList.toggle("active"),document.body.style.overflow=a.classList.contains("active")?"hidden":""}),e&&e.addEventListener("click",()=>{t.classList.remove("active"),a.classList.remove("active"),n&&n.classList.remove("active"),document.body.style.overflow=""}),n&&n.addEventListener("click",()=>{t.classList.remove("active"),a.classList.remove("active"),n.classList.remove("active"),document.body.style.overflow=""}),a.querySelectorAll(".nav-link, .nav-admin-link").forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("active"),a.classList.remove("active"),n&&n.classList.remove("active"),document.body.style.overflow=""})}))}function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){var t=this.getAttribute("href");"#"!==t&&(e.preventDefault(),e=document.querySelector(t))&&(t=document.getElementById("navbar").offsetHeight,e=e.offsetTop-t,window.scrollTo({top:e,behavior:"smooth"}))})})}function initScrollAnimations(){let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animate-in")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".feature-card, .course-card, .service-card, .testimonial-card, .advantage-card, .contact-card, .faq-item").forEach(e=>{e.classList.add("animate-element"),t.observe(e)})}document.addEventListener("DOMContentLoaded",function(){initNavbar(),initMobileMenu(),initSmoothScroll(),initScrollAnimations(),initFAQ(),initActiveNavLink(),initCourseFilter(),initCurriculumTabs(),initShareCourse(),initCounterAnimation(),initTestimonialsSlider(),initContactForm(),initChatWidget(),initDynamicCopyright()});let animationStyles=document.createElement("style");function initFAQ(){let e=document.querySelectorAll(".faq-item");e.forEach(t=>{t.querySelector(".faq-question").addEventListener("click",()=>{e.forEach(e=>{e!==t&&e.classList.contains("active")&&e.classList.remove("active")}),t.classList.toggle("active")})})}function initActiveNavLink(){let e=document.querySelectorAll("section[id]"),t=document.querySelectorAll(".nav-link");window.addEventListener("scroll",()=>{let a="",n=document.getElementById("navbar").offsetHeight;e.forEach(e=>{var t=e.offsetTop-n-100;window.scrollY>=t&&window.scrollY<t+e.offsetHeight&&(a=e.getAttribute("id"))}),t.forEach(e=>{e.classList.remove("active");var t=e.getAttribute("href");(t==="#"+a||t.includes("#")&&t.endsWith("#"+a))&&e.classList.add("active")})})}function initCourseFilter(){let i=document.querySelectorAll(".filter-tab"),o=document.querySelectorAll(".course-category");if(0!==i.length&&0!==o.length){i.forEach(n=>{n.addEventListener("click",()=>{i.forEach(e=>e.classList.remove("active")),n.classList.add("active");let t=n.getAttribute("data-filter");o.forEach(e=>{"all"===t||e.getAttribute("data-category")===t?e.classList.remove("hidden"):e.classList.add("hidden")});var e,a=document.querySelector(".courses-page")||document.querySelector(".services-page");a&&(e=document.getElementById("navbar")?.offsetHeight||0,window.scrollTo({top:a.offsetTop-e-20,behavior:"smooth"}))})});let t=new URLSearchParams(window.location.search).get("filter");if(t){let e=Array.from(i).find(e=>e.getAttribute("data-filter")===t);e&&setTimeout(()=>e.click(),100)}}}function initCounterAnimation(){var e=document.querySelectorAll(".stat-number[data-target]");let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!e.target.classList.contains("counted")&&(e.target.classList.add("counted"),(a=>{let n=parseFloat(a.getAttribute("data-target")),i=a.hasAttribute("data-decimal"),o=performance.now(),r=e=>{var e=e-o,e=Math.min(e/2e3,1),t=1-Math.pow(1-e,4),t=n*t;i?a.textContent=t.toFixed(1):a.textContent=Math.floor(t),e<1?requestAnimationFrame(r):a.textContent=i?n.toFixed(1):n};requestAnimationFrame(r)})(e.target))})},{threshold:.5});e.forEach(e=>t.observe(e))}function initTestimonialsSlider(){var n=document.querySelector(".testimonials-slider");if(n){var r=n.querySelectorAll(".testimonial-card");if(0!==r.length){let i=0,t=r.length,a=n.querySelector(".testimonials-track"),o=(a||((a=document.createElement("div")).className="testimonials-track",r.forEach(e=>a.appendChild(e.cloneNode(!0))),n.innerHTML="",n.appendChild(a)),document.createElement("div")),e=(o.className="slider-dots",n.appendChild(o),c(),setInterval(d,5e3));function c(){o.innerHTML="";var e=l(),a=t-e+1;if(!(a<=1))for(let t=0;t<a;t++){var n=document.createElement("button");n.className="slider-dot "+(t===i?"active":""),n.setAttribute("aria-label","Go to slide "+(t+1)),n.addEventListener("click",()=>{return e=t,i=e,void s();var e}),o.appendChild(n)}}function s(){var e=100/l();a.style.transform=`translateX(-${i*e}%)`,o.querySelectorAll(".slider-dot").forEach((e,t)=>{e.classList.toggle("active",t===i)})}function l(){return 1024<=window.innerWidth?3:768<=window.innerWidth?2:1}function d(){var e=l(),e=t-e;i=i>=e?0:i+1,s()}n.addEventListener("mouseenter",()=>clearInterval(e)),n.addEventListener("mouseleave",()=>{e=setInterval(d,5e3)}),window.addEventListener("resize",()=>{i=0,c(),s()})}}}function initContactForm(){var e=document.querySelectorAll("#contactForm, #service-contact-form, #courses-inquiry-form");0!==e.length&&e.forEach(e=>{setupFormSync(e)})}function setupFormSync(f){var e=f.querySelector('input[type="tel"]');e&&e.addEventListener("input",function(e){this.value=this.value.replace(/[^0-9]/g,"").slice(0,10)}),f.addEventListener("submit",async function(t){t.preventDefault();var t=f.querySelector('button[type="submit"]'),i=t.innerHTML;try{t.disabled=!0,t.setAttribute("data-original-text",i),t.innerHTML='<span class="loading-spinner"></span> Sending...';var o=new FormData(f);let a=!1,n="WEB-"+Date.now();if(window.supabaseClient)try{var r,{data:c,error:s}=await window.supabaseClient.from("inquiries").select("inquiry_id").order("inquiry_id",{ascending:!1}).limit(1);s&&console.warn("Could not read existing inquiries (check RLS):",s);let e=1;c&&0<c.length&&(r=c[0].inquiry_id.match(/(\d+)$/))&&(e=parseInt(r[1])+1),n="INQ-ACS-"+String(e).padStart(3,"0");var l=o.get("interest")||o.get("course");let t=[];l&&"Other"!==l&&(t=[l]);var d=(await window.supabaseClient.from("inquiries").insert({inquiry_id:n,name:o.get("name"),email:o.get("email"),phone:o.get("phone")||"-",courses:t,source:"Website",status:"New",demo_required:!1,notes:o.get("message")||o.get("query")||"-"})).error;if(d)throw d;a=!0}catch(e){console.error("Supabase Sync Error:",e)}let e=!1;try{var u=await fetch(f.action,{method:"POST",body:o,headers:{Accept:"application/json"}});e=u.ok}catch(e){console.error("Formspree submission failed:",e)}var m,h,v=f.closest(".contact-form-card")||document.querySelector(".contact-form-wrapper");v&&(m=o.get("name"),h=a||e?`Thank you for reaching out, <strong>${m}</strong>. Your inquiry has been received (ID: ${n}) and we'll get back to you shortly.`:`Thank you for reaching out, <strong>${m}</strong>. If you don't hear from us soon, please contact us directly via WhatsApp.`,v.innerHTML=`
                    <div class="success-message-container" style="text-align: center; padding: 40px; animation: fadeIn 0.5s ease;">
                        <div class="success-icon" style="width: 80px; height: 80px; background: rgba(0, 184, 148, 0.1); color: #00B894; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2.5rem;">
                            <i class="fas fa-check"></i>
                        </div>
                        <h3 style="margin-bottom: 10px; font-size: 1.5rem; color: var(--text-dark);">Inquiry Received!</h3>
                        <p style="color: var(--text-light); line-height: 1.6; margin-bottom: 20px;">${h}</p>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn btn-outline" style="margin-top: 0;" onclick="window.location.reload()">Send Another Message</button>
                            <a href="https://wa.me/917842239090?text=Hi! I just submitted an inquiry (ID: ${n})." target="_blank" class="btn btn-primary" style="margin-top: 0;">
                                <i class="fab fa-whatsapp"></i> Contact on WhatsApp
                            </a>
                        </div>
                    </div>
                `)}catch(e){console.error("Error submitting form:",e);s=f.closest(".contact-form-card")||document.querySelector(".contact-form-wrapper");s?s.innerHTML=`
                <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.2);">
                    <div style="width: 80px; height: 80px; background: rgba(239, 68, 68, 0.1); color: #EF4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2.5rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3 style="margin-bottom: 10px; font-size: 1.5rem; color: var(--text-dark);">Something Went Wrong</h3>
                    <p style="color: var(--text-light); line-height: 1.6; margin-bottom: 20px;">
                        We couldn't process your inquiry right now. Please try again or contact us directly.
                    </p>
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-outline" onclick="window.location.reload()">Try Again</button>
                        <a href="https://wa.me/917842239090" target="_blank" class="btn btn-primary">
                            <i class="fab fa-whatsapp"></i> Contact on WhatsApp
                        </a>
                        <a href="tel:+917842239090" class="btn btn-secondary">
                            <i class="fas fa-phone"></i> Call Us
                        </a>
                    </div>
                </div>
            `:(alert("Something went wrong. Please try again or contact us via WhatsApp at +91 7842239090."),t.disabled=!1,t.innerHTML=i)}}),"true"===new URLSearchParams(window.location.search).get("submitted")&&(e=f.closest(".contact-form-card")||document.querySelector(".contact-form-wrapper"))&&(e.innerHTML=`
                <div style="text-align: center; padding: 40px;">
                    <i class="fas fa-check-circle" style="font-size: 4rem; color: #00B894; margin-bottom: 20px;"></i>
                    <h3 style="margin-bottom: 10px;">Message Sent!</h3>
                    <p style="color: #666;">Thank you for reaching out. We'll get back to you within 24 hours.</p>
                </div>
            `)}function initCurriculumTabs(){let a=document.querySelectorAll(".curriculum-tab"),n=document.querySelectorAll(".curriculum-level");0!==a.length&&a.forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.level;a.forEach(e=>e.classList.remove("active")),e.classList.add("active"),n.forEach(e=>{e.dataset.level===t?e.classList.add("active"):e.classList.remove("active")})})})}function initShareCourse(){var e=document.querySelectorAll(".share-icon");if(0!==e.length){let i=encodeURIComponent(window.location.href);encodeURIComponent(document.title);let o=encodeURIComponent("Check out this course: "+document.title);e.forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();let t="";switch(n.dataset.share){case"linkedin":t="https://www.linkedin.com/sharing/share-offsite/?url="+i,window.open(t,"_blank","width=600,height=500");break;case"instagram":return copyToClipboard(window.location.href,n),void alert("Link copied! You can now paste it in your Instagram story or bio.");case"sms":var a="Check out this course at Abhi's Craft Soft: "+window.location.href;t="sms:?body="+encodeURIComponent(a),window.location.href=t;break;case"twitter":t=`https://twitter.com/intent/tweet?url=${i}&text=`+o,window.open(t,"_blank","width=600,height=400");break;case"copy":copyToClipboard(window.location.href,n)}})})}}function copyToClipboard(a,n){navigator.clipboard.writeText(a).then(()=>{let e=n.innerHTML;n.classList.add("copied"),n.innerHTML='<i class="fas fa-check"></i>',setTimeout(()=>{n.classList.remove("copied"),n.innerHTML=e},2e3)}).catch(e=>{var t=document.createElement("textarea");t.value=a,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),n.classList.add("copied"),setTimeout(()=>n.classList.remove("copied"),2e3)})}function initChatWidget(){let t=document.getElementById("chatWidget");var e=document.getElementById("chatToggle");t&&e&&(e.addEventListener("click",()=>{t.classList.toggle("active")}),document.addEventListener("click",e=>{!t.contains(e.target)&&t.classList.contains("active")&&t.classList.remove("active")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&t.classList.contains("active")&&t.classList.remove("active")}))}function initDynamicCopyright(){var e=document.querySelectorAll(".footer-bottom p, .copyright-text");let t=(new Date).getFullYear();e.forEach(e=>{e.textContent.includes("©")&&(e.textContent=e.textContent.replace(/© \d{4}/,"© "+t))})}animationStyles.textContent=`
    .animate-element {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.6s ease, transform 0.6s ease;
    }
    
    .animate-element.animate-in {
        opacity: 1;
        transform: translateY(0);
    }
    
    .feature-card:nth-child(2), .course-card:nth-child(2), .advantage-card:nth-child(2),
    .testimonial-card:nth-child(2) {
        transition-delay: 0.1s;
    }
    
    .feature-card:nth-child(3), .course-card:nth-child(3), .advantage-card:nth-child(3),
    .testimonial-card:nth-child(3) {
        transition-delay: 0.2s;
    }
    
    .feature-card:nth-child(4), .course-card:nth-child(4), .advantage-card:nth-child(4) {
        transition-delay: 0.3s;
    }
    
    .advantage-card:nth-child(5) {
        transition-delay: 0.4s;
    }
    
    .advantage-card:nth-child(6) {
        transition-delay: 0.5s;
    }
`,document.head.appendChild(animationStyles);